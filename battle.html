<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pokemon Battle</title>
    <style>
      .info-container {
        display: flex;
        align-items: baseline;
        gap: 50px;
      }
      .pokemon-all-container {
        display: flex;
        align-items: baseline;
        gap: 400px;
      }
    </style>
  </head>
  <body>
    <div class="info-container">
      <div class="txt-container">
        <p>Squirtle</p>
        <p id="squirtle-hp-txt">44 / 44 HP</p>
        <p id="squirtle-level-txt">0 / 36 Level</p>
        <p id="squirtle-money-txt">0 penger</p>
      </div>
      <div class="txt-container">
        <p>Vulpix</p>
        <p id="vulpix-hp-txt">38 / 38 HP</p>
        <p id="vulpix-level-txt">0 / 20 Level</p>
        <p id="vulpix-money-txt">0 Penger</p>
      </div>

      <div class="txt-container">
        <p>Pikachu</p>
        <p id="pikachu-hp-txt">35 / 35 Level</p>
        <p id="pikachu-level-txt">0 / 20 Level</p>
        <p id="pikachu-money-txt">0 Penger</p>
      </div>
    
    <img
      src="/assets/pokemonBall.jpg"
      id="squirtle"
      alt="pokemonBall"
      width="120px"
      height=""
    />
    <img
      src="/assets/pokemonBall.jpg"
      id="vulpix"
      alt="pokemonBall"
      width="120px"
      height=""
    />
    <input type="button" value="Angrip" id="attack-btn"/>
  </div>
    <div class="pokemon-all-container">
    <div class="pokemon-container"></div>
    <div class="bad-guy-container"></div>
  </div>
    <script>
      let squirtleHpTxt = document.querySelector("#squirtle-hp-txt");
      let vulpixHpTxt = document.querySelector("#vulpix-hp-txt");
      let pikachuHpTxt = document.querySelector("#pikachu-hp-txt");

      let squirtleLevelTxt = document.querySelector("#squirtle-level-txt");
      let vulpixLevelTxt = document.querySelector("#vulpix-level-txt");
      let pikachuLevelTxt = document.querySelector("#pikachu-level-txt");

      let squirtleMoneyTxt = document.querySelector("#squirtle-money-txt");
      let vulpixMoneyTxt = document.querySelector("#vulpix-money-txt");
      let pikachuMoneyTxt = document.querySelector("#pikachu-money-txt");

      const squirtle = document.querySelector("#squirtle");
      const vulpix = document.querySelector("#vulpix");
      const pokemonContainer = document.querySelector(".pokemon-container");
      const badGuyContainer = document.querySelector(".bad-guy-container");
      const pokemonAllContainer = document.querySelector(".pokemon-all-container");
      let pokemonGood = [];
      let pokemonBad = [];

      

      async function fetchBattlePokemon(name) {
        const pokemonRequest = await fetch(
          `https://pokeapi.co/api/v2/pokemon/${name}/`
        );
        let response = await pokemonRequest.json();
        return response;
      }
      fetchAndShowBadPokemon("pikachu");

      async function fetchAndShowBadPokemon(pikachu) {
        try {
          pokemonsId = [];
          
         idOfPokemon = await fetchBattlePokemon(pikachu);
          pokemonsId.push(idOfPokemon);
          console.log("hvor mange", pokemonsId);
          pokemonBad = pokemonsId.map((pokemon) => ({
            name: pokemon.name,
            image: pokemon.sprites.other["official-artwork"].front_default,
            type: pokemon.types[0].type.name,
            hp: pokemon.stats[0].base_stat,
            attack: pokemon.stats[1].base_stat,
            defense: pokemon.stats[2].base_stat,
            specialAttack: pokemon.stats[3].base_stat,
            specialDefense: pokemon.stats[4].base_stat,
            speed: pokemon.stats[5].base_stat,
            level: 0,
            money: 0,
          }));
          showBadPokemon(pokemonBad);
        } catch (error) {
          console.error("Her klarte vi ikke 책 lase inn pokemons", error);
        }
      }

      async function fetchAndShowPokemon(name) {
        try {
          pokemonsId = [];
          
         idOfPokemon = await fetchBattlePokemon(name);
          pokemonsId.push(idOfPokemon);
          console.log("hvor mange", pokemonsId);
          pokemonGood = pokemonsId.map((pokemon) => ({
            name: pokemon.name,
            image: pokemon.sprites.other["official-artwork"].front_default,
            type: pokemon.types[0].type.name,
            hp: pokemon.stats[0].base_stat,
            attack: pokemon.stats[1].base_stat,
            defense: pokemon.stats[2].base_stat,
            specialAttack: pokemon.stats[3].base_stat,
            specialDefense: pokemon.stats[4].base_stat,
            speed: pokemon.stats[5].base_stat,
            level: 0,
            money: 0,
          }));
          console.log("hvor mange", pokemonGood);
          showGoodPokemon(pokemonGood);
        } catch (error) {
          console.error("Her klarte vi ikke 책 lase inn pokemons", error);
        }
      }
     
      function showGoodPokemon(pokemons) {
        console.log("Showing Pokemon:", pokemons);
        pokemonContainer.innerHTML = "";
        pokemons.forEach((pokemon, index) => {
          const pickMeBtn = document.createElement("button");
          pickMeBtn.innerHTML = "Velg meg";
          pickMeBtn.style.backgroundColor = "white";
          pickMeBtn.addEventListener("click", function() {
            startGame(pokemon);
          })
          
          const pokemonCard = document.createElement("div");
          pokemonContainer.style.display = "flex";
          pokemonContainer.style.flexWrap = "wrap";
          pokemonContainer.style.gap = "10px";
          
          pokemonCard.style.background =
            pokemon.type == "water"
              ? "#1451E3"
              : pokemon.type == "fire"
              ? "#AA1E21"
              : 
          pokemonCard.style.width = "200px";
          pokemonCard.style.height = "460px";
          pokemonCard.style.padding = "10px";
          pokemonCard.innerHTML = `<img src="${pokemon.image}" style="width: 200px" />
      <h3>Navn: ${pokemon.name} <br>Type: ${pokemon.type}</h3> <h4>STATS<br>HP: ${pokemon.hp}<br>Attack: ${pokemon.attack}<br>Defense: ${pokemon.defense}<br>Special attack: ${pokemon.specialAttack}<br> Special defense: ${pokemon.specialDefense}<br> Speed: ${pokemon.speed}</h4>`;
          pokemonCard.append(pickMeBtn);
          pokemonContainer.appendChild(pokemonCard);
        });
      }
      function showBadPokemon(pokemonInfo) {
      console.log("vis pika", pokemonInfo);
      const pokemon = pokemonInfo[0]; //chat
          const pokemonBadCard = document.createElement("div");
         // pokemonBadCard.style.marginLeft = "auto";
          badGuyContainer.style.display = "flex";
          badGuyContainer.style.flexWrap = "wrap";
          badGuyContainer.style.gap = "10px";
         // pokemonBadCard.style.position = "fixed";
          pokemonBadCard.style.background =
            pokemon.type == "electric"
              ? "#E2E22A"
              : 
         pokemonBadCard.style.width = "200px";
          pokemonBadCard.style.height = "460px";
          pokemonBadCard.style.padding = "10px";
          pokemonBadCard.innerHTML = `<img src="${pokemon.image}" style="width: 200px" />
      <h3>Navn: ${pokemon.name} <br>Type: ${pokemon.type}</h3> <h4>STATS<br>HP: ${pokemon.hp}<br>Attack: ${pokemon.attack}<br>Defense: ${pokemon.defense}<br>Special attack: ${pokemon.specialAttack}<br> Special defense: ${pokemon.specialDefense}<br> Speed: ${pokemon.speed}</h4>`;

          badGuyContainer.appendChild(pokemonBadCard);
        };
      

      squirtle.addEventListener("click", () => {
        squirtle.src = "/assets/open.jpg";
        fetchAndShowPokemon("squirtle");
      });
      vulpix.addEventListener("click", () => {
        vulpix.src = "/assets/open.jpg";
        fetchAndShowPokemon("vulpix");
      });

     /* function attackBtn(pokemon) {
        const attackBtn = document.querySelector("#attack-btn") 
        attackBtn.addEventListener("click", function() {
//function som starter attack
console.log("jeg ble trykket p책", pokemon)
        });
      }*/
      function attackNow(pokemon){
      document.addEventListener("keydown", function (event) {
        if (event.key == "a") {
          console.log("jeg ble trykket p책", pokemon)
        }
      })};
      function startGame(pokemon) {
        /// en knapp, kanskje?
        console.log("start game", pokemon)
        attackNow(pokemon);
      }
    </script>
  </body>
</html>
